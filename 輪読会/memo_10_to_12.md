前回記事：  
[輪読会メモ：リーダブルコード（第1~3章）](https://qiita.com/takumi_links/items/34e98d7dbbe0532a69d1)  
[輪読会メモ：リーダブルコード（第4~6章）](https://qiita.com/takumi_links/items/1d85f91cbaf6ab1c03ec)  
[輪読会メモ：リーダブルコード（第7~9章）]([https://qiita.com/takumi_links/items/1d85f91cbaf6ab1c03ec](https://qiita.com/takumi_links/items/06a0217d2a7459a0c83d))  
の続きになります。

今回は第10章～第12章まで。
7~9章は、**ループとロジックの単純化**が大きなテーマとなっています。
実装にとても関わってくる章かなと感じました。（**普段の業務に応用できる内容がとても多かった印象です**）

## 第7章：制御フローを読みやすくする
> **条件やループなどの制御フローはできるだけ「自然」にする。コードの読み手が立ち止まったり読み返したりしないように書く。**  
（「リーダブルコード」p.84より）
  - いきなり耳の痛い言葉が舞い込んできました・・・。読み手が立ち止まらずに読めるコードを書いているだろうか。自戒。。

> **7.1 条件式の引数の並び順**  
**左側：「調査対象」の式、変化する / 右側：「比較対象」の式、あまり変化しない**  
（「リーダブルコード」p.84~85より）

```javascript
if (length => 10) 
```
  - 実はこれまで自分自身、あまり統一できてない部分でした。**「調査対象」を左側に、「比較対象」を右側に**、という指針は条件式を書く上で今後徹底します。

> **7.2 if/elseブロックの並び順**  
**条件は否定形よりも肯定形を使う。**  
**単純な条件を先に書く。**  
**関心を引く条件や目立つ条件を先に書く。**  
（「リーダブルコード」p.86~88より）
- 並び順もこれまではあまり意識できてなかったなーと反省。特に、「**条件は否定形よりも肯定形を使う。**」は特に使えてなかったので今後注意。

```php
// 自分がよく書いてるコード
if (!empty($value)) {
    // 空じゃなかったら
} else {
    // 空だったら
}

// こっちのほうがよい
if (empty($value)) {
    // 空
} else {
    // 空じゃなかったら
}
```

> **7.3 三項演算子**  
**基本的にはif/elseを使おう。三項演算子はそれによって簡潔になるときにだけ使おう。**  
（「リーダブルコード」p.88~89より）
- 行数を短くできればもちろん素晴らしいが、何よりも大事なのは「**他の人が理解するのにかかる時間を短くする**」こと。分かりやすいコードを書くように心がける。

> **7.5 関数から早く返す**  
（「リーダブルコード」p.91~92より）
- 「**関数で複数のreturn文を使ってはいけないと思っている人がいる**」←これ、結構いるみたい。自分は早期リターンを多用するんですが、早期リターンを書くのが怖い（というか、慣れてないだけ）のプログラマーも多そう。
  - 関数から早く返すことは悪くない、というのをレビュー時等に教えていこう。

> **7.7 ネストを浅くする**  
（「リーダブルコード」p.93~96より）
- ネストの深いコードを読むのは辛い・・・**ネストが3段階を超えたら**何かおかしいなぁ・・・と判断するぐらいがいいかもしれない。

## 第8章：巨大な式を分割する
> **巨大な式は飲み込みやすい大きさに分割する。**  
**8.1 説明変数**  
**式の意味を説明する**  
（「リーダブルコード」p.100より）
- 式の意味を表す変数を定義してあげると、読み手の理解が早い
```java
// 更新対象の商材情報を取得
Optional<ProductDto> optProductDto =
  productGetService.getProductById(productId);

// 商材名を取得
String productName = optProductDto.isPresent()
  ? StringUtils.defaultString(optProductDto.get().getName())
  : "";
```

## 第9章：変数と読みやすさ
> **9-1. 変数を削除する**  
**breakが使えないようなネストが何段階もあるループでは、コード（ループの内部のコードやループ全体）を新しい関数に移動するといい。**  
（「リーダブルコード」p.112~115より）
- バッチ処理を実装することが多いのだが、色々なデータをループ回しがちでネストが深くなりやすい。ループ内のロジックは関数側に書くなど工夫したい。

> **9-2. 変数のスコープを縮める**  
（「リーダブルコード」p.115~122より）
- すべての変数のスコープを縮める
  - 変数を定義した位置からなるべく離れずに使うのが保守性向上にはよい。（基準としては定義したい位置から数行：5行ぐらい？）もし定義位置から使う箇所が大きく離れてしまったら、ロジックを再考したいほうがよさそう。
  - 大きいバッチ処理の実装等していると、遠いところに宣言した変数を参照しがち・・・。変数位置が遠いと、変数の内容を覚えておく必要があるので大変。
- **大きなクラスを小さなクラスに分割する**
  - 「データを分割する」意識をもって、ロジックを作る前にデータのモデリングをしたほうがいいかもしれない。考えながら作ると、巨大なクラスになりがち。。

> **9-3. 変数は一度だけ書き込む**  
（「リーダブルコード」p.123~124より）
- 基本的には変数は変更不可（**イミュータブル**）であるべき。
- 早期リターンは怖くない。最後まで無駄なロジックを引っ張るぐらいなら、早めにリターンしちゃえ。

## 第7~9章 まとめ
業務システムを開発する際には複雑なビジネスロジックを組むことが多くあります。その中にはたくさんの制御フローが入ってきます。  
たくさんの制御フローがあると、どうしてもコードが読みにくくなりがち・・・。処理を分割したり、変数のスコープを意識したり、と  
最低限のことは意識してきたつもりでしたが、常に意識してコードを書いてきたかと言われると自信がなくなってきます。  

今回、リーダブルコードを改めて読み直し、読みやすいコードを書く上で大切なことを明文化できているなぁという実感があります。  
一通り読み終えたら、今回の読書メモを簡略化してまとめて、自分用の「**コーティングの際に気を付けることリスト**」を作ろうと思います。
